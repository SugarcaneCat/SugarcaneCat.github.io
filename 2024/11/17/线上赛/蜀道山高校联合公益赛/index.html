<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"/><meta name="theme-color" content="#222"/><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/><meta name="renderer" content="webkit"/><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="alternate" href="/rss.xml" title="Sugarcane" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Sugarcane" type="application/atom+xml"><link rel="alternate" type="application/json" title="Sugarcane" href="http://example.com/feed.json"/><link rel="preconnect" href="https://s4.zstatic.net"/><link rel="preconnect" href="https://at.alicdn.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.14"><link rel="modulepreload" href="/js/chunk-DVDL7G4S.js"></link><link rel="modulepreload" href="/js/chunk-GBV2ZIBI.js"></link><link rel="modulepreload" href="/js/chunk-GDLFRF3G.js"></link><link rel="modulepreload" href="/js/chunk-ISPT72BG.js"></link><link rel="modulepreload" href="/js/chunk-OHQHTEBD.js"></link><link rel="modulepreload" href="/js/chunk-WIQECBEN.js"></link><link rel="modulepreload" href="/js/comments-WGJB75N3.js"></link><link rel="modulepreload" href="/js/copy-tex-CBTQFTWH.js"></link><link rel="modulepreload" href="/js/index.esm-C4VWZ353.js"></link><link rel="modulepreload" href="/js/post-VENRTBRG.js"></link><link rel="modulepreload" href="/js/quicklink-G5OKDA77.js"></link><link rel="modulepreload" href="/js/search-QLOX4USE.js"></link><link rel="modulepreload" href="/js/siteInit.js"></link><link rel="modulepreload" href="/js/waline-IBJI4CE3.js"></link><link rel="stylesheet" href="/css/comments-LAB2J3GR.css" media="none" onload="this.media&#x3D;&#39;all&#39;"></link><link rel="stylesheet" href="/css/siteInit.css" media="none" onload="this.media&#x3D;&#39;all&#39;"></link><link rel="stylesheet" href="/css/waline-7JVHAYE3.css" media="none" onload="this.media&#x3D;&#39;all&#39;"></link><link rel="preload" href="https://i.postimg.cc/MT7v75Xy/IMG-2226.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://i.postimg.cc/KvHvgwQ6/IMG-2098.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://i.postimg.cc/dt6vpRMS/IMG-7474.png" as="image" fetchpriority="high"><link rel="preload" href="https://i.postimg.cc/hvMvwGLv/IMG-2196.png" as="image" fetchpriority="high"><link rel="preload" href="https://i.postimg.cc/G21DdrgG/wallhaven-vqgzql.png" as="image" fetchpriority="high"><link rel="preload" href="https://i.postimg.cc/hv0QBsBS/IMG-2334.jpg" as="image" fetchpriority="high"><meta name="keywords" content="线上赛"/><meta name="description" content="甘蔗🐭🐭的小破站，记录自己的生活~"/><link rel="canonical" href="http://example.com/2024/11/17/%E7%BA%BF%E4%B8%8A%E8%B5%9B/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E8%81%94%E5%90%88%E5%85%AC%E7%9B%8A%E8%B5%9B/"><title>蜀道山高校联合公益赛</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">蜀道山高校联合公益赛</h1><div class="meta"><span class="item" title="创建时间：2024-11-17 00:00:00"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2024-11-17T00:00:00+08:00">2024-11-17</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>12k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>11 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">甘蔗の农场园</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://i.postimg.cc/MT7v75Xy/IMG-2226.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://i.postimg.cc/KvHvgwQ6/IMG-2098.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://i.postimg.cc/dt6vpRMS/IMG-7474.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://i.postimg.cc/hvMvwGLv/IMG-2196.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://i.postimg.cc/G21DdrgG/wallhaven-vqgzql.png&quot;);"></li><li class="item" style="background-image: url(&quot;https://i.postimg.cc/hv0QBsBS/IMG-2334.jpg&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemListElement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" itemprop="item" rel="index" title="分类于线上赛"><span itemprop="name">线上赛<meta itemprop="position" content="0"/></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2024/11/17/%E7%BA%BF%E4%B8%8A%E8%B5%9B/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E8%81%94%E5%90%88%E5%85%AC%E7%9B%8A%E8%B5%9B/"/><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"/><meta itemprop="name" content="甘蔗"/><meta itemprop="description" content=", 甘蔗🐭🐭的小破站，记录自己的生活~"/></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Sugarcane"/></span><div class="body md" itemprop="articleBody"><h1 id="蜀道山高校联合公益赛"><a class="anchor" href="#蜀道山高校联合公益赛">#</a> 蜀道山高校联合公益赛</h1>
<blockquote>
<p>搬运的 “我们中出了一个内鬼” 团队的 WP</p>
</blockquote>
<h2 id="misc"><a class="anchor" href="#misc">#</a> MISC</h2>
<h3 id="golf"><a class="anchor" href="#golf">#</a> Golf</h3>
<p>全⻆字符绕过阻⽌名单</p>
<p><code>ｅｘｅｃ(ｉｎｐｕｔ())</code></p>
<p><a target="_blank" rel="noopener" href="https://postimg.cc/jWSQkY1W"><img loading="lazy" data-src="https://i.postimg.cc/g0vSjYqK/QQ20241119-192628.png" alt="QQ20241119-192628.png" /></a></p>
<h3 id="summit-potato"><a class="anchor" href="#summit-potato">#</a> Summit Potato</h3>
<p>Potato.png 数据流后⾯分离出 xlsx ⽂件 (这里用<strong> Foremost</strong> 出来 xlsx 文件，Binwalk 提取出来的打开有问题)，第⼆个⼯作表按逻辑得到  <code>Loe*n</code>  （第四个字符可以是任意字符），⽤来对 key.bin.xored 循环异或，根据语义和异或的规律尝试得到第四个字符为 n<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/9Dswy49Q"><img loading="lazy" data-src="https://i.postimg.cc/5t25dLNL/175317-BC91-AE17-AF4-C88-C158-D4-C002-A2.png" alt="175317-BC91-AE17-AF4-C88-C158-D4-C002-A2.png" /></a><br />
<a target="_blank" rel="noopener" href="https://postimg.cc/yW7ghCDc"><img loading="lazy" data-src="https://i.postimg.cc/9X7dhWV8/QQ20241119-194238.png" alt="QQ20241119-194238.png" /></a></p>
<p>下载：<a target="_blank" rel="noopener" href="https://github.com/CelestialCartographers/Loenn">https://github.com/CelestialCartographers/Loenn</a></p>
<p>相关问题：<a target="_blank" rel="noopener" href="https://wiki.biligame.com/celeste/Loenn">https://wiki.biligame.com/celeste/Loenn</a></p>
<p>再下⼀个蔚蓝，就可以打开 xor 后的地图<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/87QZwCMt"><img loading="lazy" data-src="https://i.postimg.cc/jSCBxw50/QQ20241119-200347.png" alt="QQ20241119-200347.png" /></a><br />
xlsx 解压后，在 media 有⼀个图⽚<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/JtXJx5xC"><img loading="lazy" data-src="https://i.postimg.cc/44L5J8hy/QQ20241119-200506.png" alt="QQ20241119-200506.png" /></a><br />
<a target="_blank" rel="noopener" href="https://postimg.cc/GHcPqSpT"><img loading="lazy" data-src="https://i.postimg.cc/L6Py4cKD/QQ20241119-200547.png" alt="QQ20241119-200547.png" /></a><br />
 作为密码解开 flag.zip 压缩包</p>
<h3 id="javapcap"><a class="anchor" href="#javapcap">#</a> javaPcap</h3>
<p><a target="_blank" rel="noopener" href="https://postimg.cc/5QLWk2N1"><img loading="lazy" data-src="https://i.postimg.cc/C56M5R3Z/QQ20241119-200753.png" alt="QQ20241119-200753.png" /></a><br />
 加密⼤致流程</p>
<pre><code>cmd：base64
Method:给出，ECB
key-&gt;给出，顶真发现是bytes_to_long(cmd)（这⾥还在java的javax.crypto.spec.SecretKeySpec上卡了很久，觉得是类似于NodeJs的EVP_key，后来发现就是简单的补全截断
回显：明⽂-&gt;加密-&gt;base64-&gt;hex
</code></pre>
<p>基于逻辑进⾏解密<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/XXVPRLHd"><img loading="lazy" data-src="https://i.postimg.cc/xjHSbFLx/QQ20241119-201250.png" alt="QQ20241119-201250.png" /></a><br />
 难泵且抽象的是 CybeyChef 这⾥解不出来，找个在线妙妙⼯具<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/5XcSVN4T"><img loading="lazy" data-src="https://i.postimg.cc/nhrRqC6F/QQ20241119-201334.png" alt="QQ20241119-201334.png" /></a><br />
<a target="_blank" rel="noopener" href="https://postimg.cc/rz04wXPk"><img loading="lazy" data-src="https://i.postimg.cc/xjg3g9Gc/QQ20241119-201415.png" alt="QQ20241119-201415.png" /></a></p>
<pre><code>whoami
ls -alt
ls flag/
base64 flag/flag.zip
cat flag/hint.txt
</code></pre>
<h2 id="reverse"><a class="anchor" href="#reverse">#</a> Reverse</h2>
<h3 id="helloharmony"><a class="anchor" href="#helloharmony">#</a> HelloHarmony</h3>
<p>当成 zip 拆开，ets/modules.abc 丢进  <code>abc-decompiler</code>  ，libs/arm64-v8a/libentry.so 丢进 IDA ArkTS 层业务逻辑中，导⼊ Emmm.Eeee 进⾏凯撒加密，构造函数传参为 5，导⼊ testNapi<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/0rYvyGzk"><img loading="lazy" data-src="https://i.postimg.cc/053yZcxw/QQ20241119-183609.png" alt="QQ20241119-183609.png" /></a><br />
Native 层 sub_1F94 获得 UTF-8 字符串，从这⾥看起，进⾏了⼀系列算术运算，解密如下（IDA ⾥看到的 this 指向⼀个 256 字节的 box，this+256 指向派⽣的密钥）</p>
<pre><code>#include &lt;stdio.h&gt;
#define u8 unsigned char
#define u32 unsigned int

u8 eeeee[] =
&#123;
0xF6, 0xB0, 0xA6, 0x36, 0x9A, 0xB3, 0x2B, 0xBF, 0x94, 0x54,
0x15, 0x97, 0x93, 0x59, 0xBF, 0x50, 0x4D, 0xBF, 0x0A, 0x59,
0x06, 0xD7, 0x97, 0x50, 0xD6, 0x59, 0x54, 0xD7, 0xCF, 0x06,
0x5D, 0x20, 0x1D, 0x5A, 0x22, 0xEE, 0x99, 0x1F, 0xE1, 0x18,
&#125;;

int main() &#123;
    u8 box[256] = &#123;&#125;;
    // banana
    for (int i = 0; i &lt; 256; ++i)
        box[i] = (167 * i + 173) % 256;
        
    u32 dkey[8] = &#123;&#125;;
    const char *a2 = &quot;HelloSDS&quot;;
    const char a3 = 8;
    // bananana
    for (int i = 0; i &lt; 8; ++i)
        dkey[i] = (a2[(i + 1) % a3] &lt;&lt; 16) | (a2[i % a3] &lt;&lt; 24) | (a2[(i + 2)% a3] &lt;&lt; 8) | a2[(i + 3) % a3];

    for (int i = 7; i &gt;= 0; i--) &#123;
        // blablabla
        u8 c = eeeee[39];
    for (int j = 39; j &gt; 0; j--) &#123;
        eeeee[j] = eeeee[j - 1];
    &#125;
    eeeee[0] = c;
    
    // bla
    for (int j = 0; j &lt; 40; j++) &#123;
        for (int k = 0; k &lt; 256; k++) &#123;
            if (box[k] == eeeee[j]) &#123;
                eeeee[j] = k;
                break;
            &#125;
        &#125;
    &#125;
    // blablablablabla
    ((u32*)eeeee)[0] ^= dkey[i];
    ((u32*)eeeee)[1] ^= dkey[i];
  &#125;
  for (int i = 0; i &lt; 40; i++) &#123;
    if ('A' &lt;= eeeee[i] &amp;&amp; eeeee[i] &lt;= 'Z') &#123;
        eeeee[i] = (eeeee[i] - 'A' - 5 + 26) % 26 + 'A';
    &#125; else if ('a' &lt;= eeeee[i] &amp;&amp; eeeee[i] &lt;= 'z') &#123;
        eeeee[i] = (eeeee[i] - 'a' - 7 + 26) % 26 + 'a';
    &#125;
    printf(&quot;%c&quot;, eeeee[i]);
    &#125;
    return 0;
   &#125;

&#125;
// LZSDS&#123;y0u_4r3_4_m4573r_0f_cryp706r4phy&#125;
</code></pre>
<h3 id="map_maze"><a class="anchor" href="#map_maze">#</a> Map_maze</h3>
<p>⼀个⻓度为 15*15 的数组，数组的元素是 {⾃⼰是否为墙的枚举值、指向上、下、左、右的指针}（幽默）</p>
<p>把构造迷宫的代码⽚段复制出来，IDE 批量⽂本替换，把它变成 int 数组并打印出来</p>
<pre><code>#include &lt;stdio.h&gt;

int maze[225] = &#123;0&#125;;

int main() &#123;
    int *v4 = maze;
    int *v5 = maze + 105;
    
for (int k = 1; k &lt; 15; ++k)
    v4[k] = 1;
for (int m = 9; m &lt; 15; ++m)
    v4[m + 15] = 1;
for (int n = 0; n &lt; 2; ++n)
    v4[n + 30] = 1;
for (int ii = 3; ii &lt; 8; ++ii)
    v4[ii + 30] = 1;
for (int jj = 9; jj &lt; 15; ++jj)
    v4[jj + 30] = 1;
for (int kk = 0; kk &lt; 2; ++kk)
    v4[kk + 45] = 1;
for (int mm = 3; mm &lt; 8; ++mm)
    v4[mm + 45] = 1;
for (int nn = 12; nn &lt; 15; ++nn)
    v4[nn + 45] = 1;
for (int i1 = 0; i1 &lt; 2; ++i1)
    v4[i1 + 60] = 1;
for (int i2 = 7; i2 &lt; 10; ++i2)
    v4[i2 + 60] = 0;
   v4[67] = 1;
for (int i3 = 11; i3 &lt; 15; ++i3)
    v4[i3 + 60] = 1;
for (int i4 = 0; i4 &lt; 2; ++i4)
    v4[i4 + 75] = 1;
for (int i5 = 3; i5 &lt; 6; ++i5)
    v4[i5 + 75] = 1;
for (int i6 = 11; i6 &lt; 15; ++i6)
    v4[i6 + 75] = 1;
for (int i7 = 0; i7 &lt; 2; ++i7)
    v4[i7 + 90] = 1;
 v4[92] = 0;
for (int i8 = 3; i8 &lt; 6; ++i8)
    v4[i8 + 90] = 1;
for (int i9 = 7; i9 &lt; 10; ++i9)
    v4[i9 + 90] = 1;
for (int i10 = 11; i10 &lt; 15; ++i10)
    v4[i10 + 90] = 1;
 v5[0] = 1;
 v5[1] = 0;
 v5[2] = 0;
 v5[3] = 1;
for (int i11 = 4; i11 &lt; 6; ++i11)
    v5[i11] = 1;
for (int i12 = 7; i12 &lt; 10; ++i12)
    v5[i12] = 1;
for (int i13 = 11; i13 &lt; 15; ++i13)
    v5[i13] = 1;
for (int i14 = 0; i14 &lt; 2; ++i14)
    v5[i14 + 15] = 1;
for (int i15 = 7; i15 &lt; 10; ++i15)
    v5[i15 + 15] = 1;
for (int i16 = 11; i16 &lt; 15; ++i16)
    v5[i16 + 15] = 1;
for (int i17 = 0; i17 &lt; 6; ++i17)
    v5[i17 + 30] = 1;
for (int i18 = 7; i18 &lt; 10; ++i18)
    v5[i18 + 30] = 1;
for (int i19 = 11; i19 &lt; 15; ++i19)
    v5[i19 + 30] = 1;
for (int i20 = 0; i20 &lt; 6; ++i20)
    v5[i20 + 45] = 1;
for (int i21 = 11; i21 &lt; 15; ++i21)
    v5[i21 + 45] = 1;
for (int i22 = 0; i22 &lt; 9; ++i22)
    v5[i22 + 60] = 1;
for (int i23 = 13; i23 &lt; 15; ++i23)
    v5[i23 + 60] = 1;
for (int i24 = 0; i24 &lt; 9; ++i24)
    v5[i24 + 75] = 1;
 v5[84] = 0;
 v5[85] = 1;
 v5[86] = 1;
 v5[87] = 0;
for (int i25 = 13; i25 &lt; 15; ++i25)
    v5[i25 + 75] = 1;
for (int i26 = 0; i26 &lt; 9; ++i26)
    v5[i26 + 90] = 1;
 v5[99] = 0;
 v5[100] = 1;
 v5[101] = 1;
 v5[102] = 0;
for (int i27 = 13; i27 &lt; 15; ++i27)
    v5[i27 + 90] = 1;
for (int i28 = 0; i28 &lt; 12; ++i28)
    v5[i28 + 105] = 1;
    
for (int i = 0; i &lt; 15; ++i) &#123;
    for (int j = 0; j &lt; 15; ++j) &#123;
        printf(maze[i * 15 + j] ? &quot;X&quot; : &quot; &quot;);
    &#125;
    printf(&quot;\n&quot;);
&#125;

    return 0;
&#125;

// LZSDS&#123;1979869e0c4ef6c542e54ae5c48f63ec&#125;
</code></pre>
<p>迷宫有多解但是正确 flag 只有⼀个（幽默）</p>
<h3 id="potato-toolkit"><a class="anchor" href="#potato-toolkit">#</a> Potato Toolkit</h3>
<p>切到反汇编⾮图表视图，从头到尾快速粗略浏览⼀遍，找数据操作密集的位置就是主要逻辑，定位到 sub_1400012E0</p>
<p>开头判断了 a1 [6] 这个⽂本框为  <code>1wesa234</code>  ，后⾯读⼊ 38 字节并与这个⽂本框的⽂本循环异或（Aura 是真喜欢循环异或）</p>
<p>注意存储的顺序与数组中是不⼀致的（估计是编译优化）<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/wtHSGM56"><img loading="lazy" data-src="https://i.postimg.cc/Gpsd9sHs/QQ20241119-190859.png" alt="QQ20241119-190859.png" /></a><br />
 解密：<br />
<a target="_blank" rel="noopener" href="https://postimg.cc/jL46hjj6"><img loading="lazy" data-src="https://i.postimg.cc/nc6dpjbW/QQ20241119-191151.png" alt="QQ20241119-191151.png" /></a></p>
<h3 id="最高的山最的河"><a class="anchor" href="#最高的山最的河">#</a> 最⾼的⼭最⻓的河</h3>
<p>随便找⼀个 EXE 补全最前⾯ 16 字节的 MZ 头</p>
<p>开始以为考的是异常处理，后来发现只是魔改 Base64 + TEA，有⼏处坑点</p>
<p>main 中调⽤的 sub_1400112CB (sub_14001D200) 为主要加密逻辑，sub_14001D200 较⼤的 for 循环为魔改 Base64，魔改点是先取三个字节的低 6 位，然后把三个字节⾼ 2 位拼接在⼀起</p>
<p>它下⾯调⽤的 sub_140011519 (sub_14001E3F0) 第⼀个 for 循环在把 Base64 字符（以 AbC1 为例）拼接成⼩端序 u32 时调换了中间的顺序，从低地址向⾼地址依次是 A C b 1</p>
<p>第⼆个 for 循环进⾏ TEA 加密，32 轮后还异或了⼀个常数</p>
<p>它下⾯调⽤的 sub_140011113 (sub_14001DF80) 在把 u32 数组拆成字节数组时，是按 u32 从最⾼字节向最低字节的顺序依次 append 的，相当于字节序转换</p>
<p>解密如下:</p>
<pre><code>#include &lt;stdio.h&gt;

const int dword_140029DE0[5] = &#123;0x4C, 0x5A, 0x53, 0x44, 0x53&#125;;
char enc[] = &#123;165, 100, 159, 4, 57, 183, 166, 23, 34, 205, 38, 77, 125, 16,
              130, 219, 133, 219, 39, 57, 66, 60, 30, 165, 34, 205, 38, 77, 125, 16, 130,
              219, 214, 55, 104, 128, 177, 249, 21, 25, 68, 24, 66, 36, 143, 120, 162, 44&#125;;

void __fastcall sub_14001E1C0(unsigned int *a)
&#123;
    int v4; // [rsp+44h] [rbp+24h]
    int i;  // [rsp+64h] [rbp+44h]
    unsigned int v9;  // [rsp+1A8h] [rbp+188h]
    unsigned int v10; // [rsp+1B0h] [rbp+190h]

    v10 = dword_140029DE0[4] ^ a[1];
    v9 = dword_140029DE0[4] ^ a[0];
    v4 = -957401312 + 1640531527 * 32;

    for (i = 0; i &lt; 32; ++i)
    &#123;
        v4 -= 1640531527;
        v9 += (dword_140029DE0[1] + (v10 &gt;&gt; 5)) ^ (v4 + v10) ^
              (dword_140029DE0[0] + 16 * v10);
        v10 += (dword_140029DE0[3] + (v9 &gt;&gt; 5)) ^ (v4 + v9) ^
               (dword_140029DE0[2] + 16 * v9);
    &#125;

    a[1] = v10;
    a[0] = v9;
&#125;

const char *b64alphabet = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;

int getIndex(char c)
&#123;
    for (int i = 0; i &lt; 64; i++)
    &#123;
        if (b64alphabet[i] == c)
        &#123;
            return i;
        &#125;
    &#125;
    return -1;
&#125;

int main()
&#123;
    for (char *b = enc; b &lt; enc + 48; b += 4)
    &#123;
        char c = b[2];
        b[2] = b[1];
        b[1] = c;
        c = b[3];
        b[3] = b[0];
        b[0] = c;
    &#125;

    for (unsigned int *b = (unsigned int *)enc; b &lt; (unsigned int *)(enc + 48); b += 2)
    &#123;
        sub_14001E1C0(b);
    &#125;

    for (char *b = enc; b &lt; enc + 48; b += 4)
    &#123;
        char c = b[2];
        b[2] = b[1];
        b[1] = c;
    &#125;

    char flag[36];
    int i = 0;

    for (char *b = enc; b &lt; enc + 48; b += 4)
    &#123;
        char c1 = getIndex(b[0]);
        char c2 = getIndex(b[1]);
        char c3 = getIndex(b[2]);
        char msbs = getIndex(b[3]);

        flag[i++] = c1 | (msbs &gt;&gt; 4 &lt;&lt; 6);
        flag[i++] = c2 | (((msbs &gt;&gt; 2) &amp; 3) &lt;&lt; 6);
        flag[i++] = c3 | ((msbs &amp; 3) &lt;&lt; 6);
    &#125;

    printf(&quot;%s\n&quot;, flag);
    return 0;
&#125;

// // LZSDS&#123;how_how_how_how_how_ow_ow_ow!&#125;
</code></pre>
<h2 id="crypto"><a class="anchor" href="#crypto">#</a> Crypto</h2>
<h3 id="something-like-coppersmith"><a class="anchor" href="#something-like-coppersmith">#</a> Something like coppersmith</h3>
<p>dlp 问题，512bit 的 x 给了低 404bit，求解⾼位 108bit</p>
<p>查看 p-1 有⼏个⼩因⼦可以利⽤，bsgs+ph 求⼀下⾼位，拼起来就是完整的 x</p>
<pre><code>from sage.all import *
p = 6302810904265501037924401786295397288170843149817176985522767895582968290551414928308932200691953758726228011793524154509586354502691822110981490737900239
g = 37
y = 1293150376161556844462084321627758417728307246932113125521569554783424543983527961886280946944216834324374477189528743754550041489359187752209421536046860
xl = 17986330879434951085449288256517884655391850545705434564933459034981508996937405053663301303792832616366656593647019909376
enc = b'\x08[\x94\xc1\xc2\xc3\xb9&quot;C^\xd6P\xf9\x0c\xbb\r\r\xaf&amp;\x94\x8cm\x02s\x87\x8b\x1c\xb3\x92\x81H\xe7\xc6\x190a\xca\x91j\xc0@(\xc5Fw\x95\r\xee'
# 512-404=108

a = pow(g, 2**404, p)
b = y*pow(g, -xl, p)
subs = [2, 385057, 727646221919, 193893885660581]
F = GF(p)
xhs = [discrete_log_lambda(F(pow(b, (p-1)//sub, p)), F(pow(a, (p-1)//sub, p)),(0, sub)) for sub in subs]
xh = crt(xhs, subs)
x = xh*2**404 + xl
print(f&quot;&#123;xh = &#125;\n&#123;x = &#125;\n&#123;pow(g, x, p) - y&#125;&quot;)

xh = 75264534032313167327310698296002
x = 3109629341267338542281598485842430908207399697796047162247944601790472203194018819012768066635985627456532841488248491869575854365325351247411886736433408

from Crypto.Cipher import AES
import hashlib
key = hashlib.md5(str(x).encode()).digest()
aes = AES.new(key=key, mode=AES.MODE_ECB)
flag = aes.decrypt(enc)
print(flag)
</code></pre>
<h3 id="xorsa"><a class="anchor" href="#xorsa">#</a> xorsa</h3>
<p>hint1 和 hint2 异或得 p，phi 和 e 不互素，GCD ⼀下，求出 m^2，开⽅得到 flag</p>
<pre><code>import gmpy2
from Crypto.Util.number import *

c = 13760578729891127041098229431259961120216468948795732373975536417751222443069805775693845560005881981622202089883866395577154701229046245882282127054969114210307175116574178428823043817041956207503299220721042136515863979655578210499512044917781566303947681251248645504273995402630701480590505840473412765662
n = 1424703821182138520975906725684623222744416317309919908525779037059045074966520655616336475426918225535808494835434582789898723475666213397463311706290237081185546666535178402712533311266307508539567650112175978669972014909857643314181737564928779420725539793335830274229206316999461309927000523188222801659
hint1 = 8938538619961731399716016665470564084986243880394928918482374295814509353382364651201249532111268951793354572124324033902502588541297713297622432670722730
hint2 = 1493298155243474837320092849325750387759519643879388609208314494000605554020636706320849032906759121914762492378489852575583260177546578935320977613050647
e = 2026
p = hint1^hint2
q = n // p
phi = (p - 1) * (q - 1)

k = GCD(e,phi)
print(k)
d = gmpy2.invert(e//k, phi)
m = pow(c, d, n)
flag = long_to_bytes(gmpy2.iroot(m,k)[0])
print(flag)
# LZSDS&#123;fcfa4147-d982-4cd8-9ab7-50669e559736&#125;
</code></pre>
<div class="tags"><a href="/tags/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" rel="tag"><i class="ic i-tag"></i>线上赛</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2024-11-19 20:15:03" itemprop="dateModified" datetime="2024-11-19T20:15:03+08:00">2024-11-19</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.png" alt="甘蔗 微信支付"/><p>微信支付</p></div><div><img loading="lazy" data-src="/assets/alipay.png" alt="甘蔗 支付宝"/><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>甘蔗<i class="ic i-at"><em>@</em></i>Sugarcane</li><li class="link"><strong>本文链接：</strong><a href="http://example.com/2024/11/17/%E7%BA%BF%E4%B8%8A%E8%B5%9B/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E8%81%94%E5%90%88%E5%85%AC%E7%9B%8A%E8%B5%9B/" title="蜀道山高校联合公益赛">http://example.com/2024/11/17/线上赛/蜀道山高校联合公益赛/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/10/25/%E7%BA%BF%E4%B8%8A%E8%B5%9B/YLCTF2024/" rel="prev" itemprop="url" title="YLCTF2024" style="background-image: linear-gradient(to bottom right, #f7c385, #fba38d);"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>线上赛</span><h3>YLCTF2024</h3></a></div><div class="item right"><a href="/2024/11/18/%E5%AE%89%E6%81%92%E6%9D%AF/2024%E5%B9%B4%E2%80%9C%E5%AE%89%E6%81%92%E6%9D%AF%E2%80%9D/" rel="next" itemprop="url" title="2024年安恒杯" style="background-image: linear-gradient(to bottom right, #85e3df, #ded6e7);"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>安恒杯</span><h3>2024年安恒杯</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E8%81%94%E5%90%88%E5%85%AC%E7%9B%8A%E8%B5%9B"><span class="toc-number">1.</span> <span class="toc-text"> 蜀道山高校联合公益赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.1.</span> <span class="toc-text"> MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#golf"><span class="toc-number">1.1.1.</span> <span class="toc-text"> Golf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#summit-potato"><span class="toc-number">1.1.2.</span> <span class="toc-text"> Summit Potato</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#javapcap"><span class="toc-number">1.1.3.</span> <span class="toc-text"> javaPcap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse"><span class="toc-number">1.2.</span> <span class="toc-text"> Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#helloharmony"><span class="toc-number">1.2.1.</span> <span class="toc-text"> HelloHarmony</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#map_maze"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Map_maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#potato-toolkit"><span class="toc-number">1.2.3.</span> <span class="toc-text"> Potato Toolkit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E9%AB%98%E7%9A%84%E5%B1%B1%E6%9C%80%E7%9A%84%E6%B2%B3"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 最⾼的⼭最⻓的河</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">1.3.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#something-like-coppersmith"><span class="toc-number">1.3.1.</span> <span class="toc-text"> Something like coppersmith</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xorsa"><span class="toc-number">1.3.2.</span> <span class="toc-text"> xorsa</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li ><a href="/2024/10/06/%E7%BA%BF%E4%B8%8A%E8%B5%9B/0xGame2024/" rel="bookmark" title="0xGame2024">0xGame2024</a></li><li ><a href="/2024/10/25/%E7%BA%BF%E4%B8%8A%E8%B5%9B/YLCTF2024/" rel="bookmark" title="YLCTF2024">YLCTF2024</a></li><li  class="active"><a href="/2024/11/17/%E7%BA%BF%E4%B8%8A%E8%B5%9B/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E8%81%94%E5%90%88%E5%85%AC%E7%9B%8A%E8%B5%9B/" rel="bookmark" title="蜀道山高校联合公益赛">蜀道山高校联合公益赛</a></li><li ><a href="/2024/11/18/%E7%BA%BF%E4%B8%8A%E8%B5%9B/SHCTF/" rel="bookmark" title="SHCTF">SHCTF</a></li><li ><a href="/2024/11/18/%E7%BA%BF%E4%B8%8A%E8%B5%9B/BaseCTF/" rel="bookmark" title="BaseCTF">BaseCTF</a></li><li ><a href="/2024/11/18/%E7%BA%BF%E4%B8%8A%E8%B5%9B/SICTF%20Round4/" rel="bookmark" title="SICTF Round4">SICTF Round4</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="甘蔗" src="/assets/avatar.jpg"/><p class="name" itemprop="name">甘蔗</p><div class="description" itemprop="description">甘蔗🐭🐭的小破站，记录自己的生活~</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">14</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">7</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/sugarcanecat" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;sugarcanecat"><i class="ic i-github"></i></a><a target="_blank" rel="noopener" href="https://www.youtube.com/@sugarcanecat" class="item youtube" title="https:&#x2F;&#x2F;www.youtube.com&#x2F;@sugarcanecat"><i class="ic i-youtube"></i></a><a target="_blank" rel="noopener" href="https://www.instagram.com/sugarcane3at/" class="item instagram" title="https:&#x2F;&#x2F;www.instagram.com&#x2F;sugarcane3at&#x2F;"><i class="ic i-instagram"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/11/18/%E5%AE%89%E6%81%92%E6%9D%AF/2024%E5%B9%B4%E2%80%9C%E5%AE%89%E6%81%92%E6%9D%AF%E2%80%9D/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/10/25/%E7%BA%BF%E4%B8%8A%E8%B5%9B/YLCTF2024/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/hgame%E6%AF%94%E8%B5%9B/" title="分类于hgame比赛">hgame比赛</a></div><span><a href="/2024/11/18/hgame%E6%AF%94%E8%B5%9B/hgame2024-week2/">hgame比赛-week2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Sui%E5%AD%A6%E4%B9%A0/" title="分类于Sui学习">Sui学习</a></div><span><a href="/2024/07/14/Sui%E5%AD%A6%E4%B9%A0/GitHub%E6%8F%90%E4%BA%A4PR/">GitHub提交PR</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="分类于网络安全">网络安全</a></div><span><a href="/2023/11/06/Web/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%9F%B9%E8%AE%AD/">记录一次培训</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/hgame%E6%AF%94%E8%B5%9B/" title="分类于hgame比赛">hgame比赛</a></div><span><a href="/2024/11/18/hgame%E6%AF%94%E8%B5%9B/hgame2024-week1/">hgame比赛-week1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%88%91%E6%89%80%E7%83%AD%E7%88%B1%E7%9A%84/" title="分类于我所热爱的">我所热爱的</a></div><span><a href="/2024/06/29/%E6%88%91%E6%89%80%E7%83%AD%E7%88%B1%E7%9A%84/GBC-%E4%B8%80%E6%AC%A1%E9%9A%BE%E5%BF%98%E7%9A%84%E8%BF%BD%E7%95%AA%E7%BB%8F%E5%8E%86/">GIRLS BAND CRY</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" title="分类于线上赛">线上赛</a></div><span><a href="/2024/11/18/%E7%BA%BF%E4%B8%8A%E8%B5%9B/SICTF%20Round4/">SICTF Round4</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF/" title="分类于红明谷杯">红明谷杯</a></div><span><a href="/2024/04/03/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-2024/">2024红明谷杯</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Sui%E5%AD%A6%E4%B9%A0/" title="分类于Sui学习">Sui学习</a></div><span><a href="/2024/07/13/Sui%E5%AD%A6%E4%B9%A0/letsmove/">letsmove-task1</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" title="分类于线上赛">线上赛</a></div><span><a href="/2024/11/17/%E7%BA%BF%E4%B8%8A%E8%B5%9B/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E8%81%94%E5%90%88%E5%85%AC%E7%9B%8A%E8%B5%9B/">蜀道山高校联合公益赛</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%BA%BF%E4%B8%8A%E8%B5%9B/" title="分类于线上赛">线上赛</a></div><span><a href="/2024/11/18/%E7%BA%BF%E4%B8%8A%E8%B5%9B/SHCTF/">SHCTF</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">甘蔗 @ 甘蔗の农场园</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">83k 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">1:15</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `2024/11/17/线上赛/蜀道山高校联合公益赛/`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.14" type="module" fetchpriority="high" defer></script></body></html>